R=35;
Rho=1.225;
Jr=2.96e6;
Jg=53.036;
Cls=1e5;
Kls=5.6e5;
Cr=625;
Cg=0.05;
ng=87.965;
beta_opt=2;
lambda_opt=7.1;
Cp_opt=0.4857;
a11=-Cr/Jr;
a12=0;
a13=-1/Jr;
a21=0;
a22=-Cg/Jg;
a23=1/ng/Jg;
a31=Kls-Cls*Cr/Jr;
a32=(Cls*Cg/Jg-Kls)/ng;
a33=-Cls*(Jr+ng^2*Jg)/(ng^2*Jg*Jr);
b11=1/Jr;
b12=0;
b21=0;
b22=-1/Jg;
b31=Cls/Jr;
b32=Cls/ng/Jg;
filename = 'Cp.xlsx';
Cp = xlsread(filename);
filename = 'v.xlsx';
vf = xlsread(filename);
TMax = 75;

lambda=10;
eta=0.05;
phi=0.001;

A1=1/Jr;
A2=(Jr*(lambda-b31)-Cr)/Jr^2;
A3=(Cr^2-a31*Jr-lambda*Cr*Jr)/Jr^2;
A4=-a32/Jr;
A5=(Cr-a33*Jr-lambda*Jr)/Jr^2;
sim('img_Closedloop.slx',[0,TMax]);